if not syn then warn("synapse not detected! reloading script on kick will not work!") end
while game:IsLoaded() == false do wait() end
if not game.Players.LocalPlayer.Character then repeat wait() until game.Players.LocalPlayer.Character end

local ScreenGui = Instance.new("ScreenGui", game:GetService("CoreGui"))
local TextLabel = Instance.new("TextLabel")
ScreenGui.Name = tostring(math.random(1, 9999999))
TextLabel.Parent = ScreenGui
TextLabel.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
TextLabel.BackgroundTransparency = 1.000
TextLabel.Position = UDim2.new(0, 0, 0.949999988, 0)
TextLabel.Size = UDim2.new(1, 0, 0.0500000007, 0)
TextLabel.Font = Enum.Font.SourceSansBold
TextLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TextLabel.TextSize = 24.000
TextLabel.TextStrokeTransparency = 0.000
TextLabel.TextXAlignment = Enum.TextXAlignment.Right
TextLabel.TextYAlignment = Enum.TextYAlignment.Bottom

local timer = 0
local invokes = 0
local maxretries = 5
local retries = 0

local vu = game:service("VirtualUser")
game:service("Players").LocalPlayer.Idled:connect(function()
    vu:CaptureController()vu:ClickButton2(Vector2.new())
end)

game:GetService("CoreGui").RobloxPromptGui.promptOverlay.ChildAdded:connect(function(kick)
    if kick.Name == "ErrorPrompt" and kick:FindFirstChild("MessageArea") and kick.MessageArea:FindFirstChild("ErrorFrame") then
        game:GetService("TeleportService"):Teleport(game.PlaceId)
    end
end)

game:GetService("Players").LocalPlayer.OnTeleport:Connect(function(State)
    if State == Enum.TeleportState.Started then
        syn.queue_on_teleport("loadstring(game:HttpGet('https://raw.githubusercontent.com/kotsyaj/lasagnehook/roblox/petsimxautobuymerchant'))()")
    end
end)

while wait(2) do
    local isMerchantHere = game:GetService("Workspace")["__THINGS"]["__REMOTES"]["is merchant here"]:InvokeServer({})[1];
    if isMerchantHere ~= true then timer = timer + 2 invokes = invokes + 1 TextLabel.Text = string.upper(tostring(isMerchantHere) .. " [" .. tostring(timer) .. " secs / " .. string.format("%.2f", timer / 60) .. " mins]" .. " " ..  tostring(invokes) .. " invokes ") else TextLabel.Text = "Merchant Arrived! " end
    if isMerchantHere == true and s.gg ~= true then
        repeat
            retries = retries + 1
            wait(0.15)
            local tier3purchase = {
                [1] = 3
            }
            workspace.__THINGS.__REMOTES["buy merchant item"]:InvokeServer(tier3purchase)
            print("attempted to buy tier III pet!")
            if retries > maxretries then break end
        until retries > maxretries
        s.gg = true
    end
    if not (isMerchantHere and s.gg) then
        retries = 0
        s.gg = false;
    end;
end
